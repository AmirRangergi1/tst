# pdf-to-excel (Advanced Edition)

ุจุฑูุงููโ ูู ุจุฑุง ุชุจุฏู PDF ุจู Excel ุจุง ุงุณุชุฎุฑุงุฌ ุฏูู ูุญุชูุง ู ูพุดุชุจุงู ุจุฑุง ุงุณูุงุฏ ุงุณฺฉูโุดุฏู.

## โจ ูฺฺฏโูุง

- **ุงุณุชุฎุฑุงุฌ ุฌุฏุงูู ูพุดุฑูุชู**: Camelot (lattice/stream) ุจุฑุง ุฌุฏุงูู ูพฺุฏู
- **OCR ุจุง ุฏูุช ุจุงูุง**: PaddleOCR (ุจุฏูู ูุงุฒ GPU) ุจุฑุง ุงุณูุงุฏ ุงุณฺฉูโุดุฏู ู ุชุตูุฑ
- **Fallback Strategies**: ุงฺฏุฑ ฺฉ ุฑูุด ูููู ูุจูุฏุ ุฑูุด ุฏฺฏุฑ ุงูุชุญุงู ูโุดูุฏ
- **ูพุฑุฏุงุฒุด ููุงุฒ ุตูุญุงุช**: ุจุฑุง ุจูุชุฑู ุนููฺฉุฑุฏ ุฑู CPUโูุง ฺูุฏูุณุชูโุง
- **ูุญุฏูุฏุช ุขูพููุฏ**: ุชุง **100MB**
- **Streaming Response**: ุฏุงูููุฏ ูุณุชูู ูุงู Excel ุจุนุฏ ุงุฒ ุชุจุฏู

## ๐ ุงุฌุฑุง (ุณุฑุน ุจุง Docker)

```bash
# ูุตุจ ู ุงุฌุฑุง
docker-compose up -d

# ุณุฑูุณ ุฏุฑ ุฏุณุชุฑุณ
http://localhost:80  # (ุง :8000 ุงฺฏุฑ ุจุฏูู Nginx)
```

## ๐ฆ ุงุฌุฑุง ูุญู (ุจุฏูู Docker)

```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

uvicorn app.main:app --reload --port 8000
```

ุณูพุณ `http://localhost:8000` ุฑุง ุจุงุฒ ฺฉูุฏ.

## ๐ฏ ุงุณุชุฑุงุชฺ ุงุณุชุฎุฑุงุฌ (ุชุฑุชุจ ุงูููุช)

1. **Camelot** (ุงฺฏุฑ ูุตุจ ุจุงุดุฏ): ุจูุชุฑู ุจุฑุง ุฌุฏุงูู ุจุง ุฎุทูุท ุง ูุถุงโูุง ููุธู
2. **pdfplumber**: ุงุณุชุฎุฑุงุฌ ุฌุฏุงูู native ู ูุชู ุฏุฌุชุงู
3. **PaddleOCR**: ุจุฑุง ุตูุญุงุช ุงุณฺฉูโุดุฏู (ุจุฏูู ูุงุฒ GPUุ ุฏูุช ุจุงูุง)
4. **Tesseract**: Fallback OCR ุงฺฏุฑ PaddleOCR ุฏุฑุฏุณุชุฑุณ ูุจูุฏ

## ๐ ูุงุจุณุชฺฏโูุง ุณุณุชู (ุฏุฑ Docker ุดุงูู ุงุณุช)

- `ghostscript` - ุจุฑุง PDF parsing
- `tesseract-ocr` - ุจุฑุง OCR fallback
- `poppler-utils` - ุจุฑุง ุชุจุฏู PDF โ ุชุตูุฑ

## โ๏ธ ุชูุธูุงุช Nginx

ูุงู `nginx.conf` ุจุฑุง ุญูุงุช ุงุฒ ุขูพููุฏโูุง ุจุฒุฑฺฏ ูพฺฉุฑุจูุฏ ุดุฏู:
- `client_max_body_size 100M`
- Timeouts ุจุฑุง ุชุจุฏูโูุง ุทููุงู (300 ุซุงูู)
- Gzip compression ูุนุงู

## ๐ HTTPS (Production)

ุจุฑุง ูุนุงูโฺฉุฑุฏู HTTPS:
1. ฺฏูุงููุงููโูุง SSL ุฑุง ุฏุฑ ูููุฏุฑ `certs/` ูุฑุงุฑ ุฏูุฏ
2. ุฎุทูุท ูุฑุจูุท ุจู HTTPS ุฏุฑ `nginx.conf` ุฑุง uncomment ฺฉูุฏ
3. `docker-compose up -d --build` ุฑุง ุงุฌุฑุง ฺฉูุฏ

## ๐ ููููู Output

ุจุฑุง ฺฉ PDF 3 ุตูุญูโุง:
- ุตูุญู 1 ุฏุงุฑุง ุฌุฏุงูู โ `p1_table_t1`, `p1_table_t2` (Sheets)
- ุตูุญู 2 ูุชู ุณุงุฏ โ `p2_text` (Sheet)
- ุตูุญู 3 ุงุณฺฉูโุดุฏู โ `p3_text` (ุดุงูู ูุชุฌู OCR)

## ๐งช ุชุณุช ฺฉุฑุฏู

```bash
# ุจุง curl
curl -F "file=@sample.pdf" http://localhost/convert -o output.xlsx

# ุง ุงูพูฺฉุดู ูุจ ุฑุง ุจุงุฒ ฺฉูุฏ: http://localhost/static/index.html
```

## ๐ Logging

ุณุฑูุฑ ุฌุฒุฆุงุช ูุฑ ูุฑุญูู ูพุฑุฏุงุฒุด ุฑุง ุซุจุช ูโฺฉูุฏ:
```
โ Camelot available for advanced table detection
โ PaddleOCR loaded successfully
Processing 10 pages with advanced strategies...
Page 5: No text found, attempting OCR...
Page 5: PaddleOCR extracted 2345 chars
```

## ๐ง ุชูุณุนู

ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ุงุณุชุฑุงุชฺโูุง ุฌุฏุฏุ ุชูุงุจุน ุฒุฑ ุฑุง ูุฑุงุด ฺฉูุฏ:
- `extract_tables_camelot()` - ุจุฑุง ุจูุจูุฏ ุชุดุฎุต ุฌุฏูู
- `ocr_with_paddle()` - ุจุฑุง ุชูุธู ูพุงุฑุงูุชุฑูุง PaddleOCR
- `process_page()` - ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ุงุณุชุฑุงุชฺโูุง ุฌุฏุฏ

## ๐ API Endpoints

- `GET /` - ุตูุญู ุงุตู (redirect ุจู `/static/index.html`)
- `GET /health` - Health check
- `POST /convert` - ุชุจุฏู PDF (multipart form-data: `file`)
- `GET /static/index.html` - ุตูุญู ูุจ ุชฺฉโุตูุญูโุง (SPA)

## โก Performance Tips

1. **ุจุฑุง ูุงูโูุง ุจุฒุฑฺฏ**: ุงุณุชุฎุฑุงุฌ ููุงุฒ ุตูุญุงุช ุจุฑ ุฑู CPUโูุง ฺูุฏโูุณุชูโุง
2. **ุจุฑุง ุนููฺฉุฑุฏ OCR ุจูุชุฑ**: PaddleOCR ูุนูููุงู ุณุฑุนโุชุฑ ู ุฏููโุชุฑ ุงุฒ Tesseract ุงุณุช
3. **ุจุฑุง ูุญุทโูุง ูุญุฏูุฏ**: Camelot ู PaddleOCR ุงุฎุชุงุฑ ูุณุชูุฏุ ุณุฑูุณ ุจุฏูู ุขูโูุง ูู ฺฉุงุฑ ูโฺฉูุฏ

## ๐ฆ Production Deployment

ุจุฑุง Kubernetesุ Heroku ุง VPS:
1. `docker build -t pdf2xlsx .`
2. Registry ุฎูุฏ ุฑุง ุชูุธู ฺฉูุฏ (DockerHub, ECR, ...)
3. ุชุตูุฑ ุฑุง ุจู ุณุฑูุณ ุงุจุฑ deploy ฺฉูุฏ
4. ูุชุบุฑูุง ูุญุท (PORT, LOG_LEVEL) ุฑุง ุชูุธู ฺฉูุฏ
